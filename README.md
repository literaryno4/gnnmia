# Membership Inference Attach on Graph Neural networks

## 攻击数据集的构造过程

### GNN作为攻击模型

#### 概述

与传统的直接使用MLP作为攻击模型不同的是，我们的方法是使用GNN作为攻击模型，这是因为我们注意到目标模型的数据集是图，除了节点的信息之外，数据集节点之间的边也是不可忽视的信息。这是因为对于一个图数据集来说，其结构信息也会暴露成员隐私。

因此我们攻击的思路是使用GNN作为攻击模型。这样做的问题是，如何训练一个攻击模型，我们面对目标模型是普通节点分类模型，也就是说，我们直接能从目标模型拿到的信息就只是它的置信输出向量，每个置信输出和图数据集的节点一一对应。这样一个个置信向量直接并没有边相连，可以简单地用了训练MLP或神经网络模型，但无法直接训练GNN模型。

要训练GNN模型除了节点信息外，还需要节点之间的边的信息，这样才能组成一个完整的图数据集进行训练。我们从目标模型哪儿不能直接获取边信息，所以需要自己构建节点之间的边。

成员推理攻击的本质就是对置信向量节点做一个二分类任务以区分该节点在目标模型对应的输出是否为数据的成员。因此，我们在构造攻击数据集的边的时候也应该最大程度体现这一目的，即倾向于把成员节点和成员节点连接起来，非成员节点和非成员节点连接起来，其他情况节点之间没有边连接。

我们采取的方式有两种：1）直接根据模型过拟合的性质；2）利用影子模型的数据集作为参考数据集进行边的筛选和添加。

对于第一种方法，它较为简单，因为GNN模型和其他卷积神经网络一样都或多或少会有过拟合的现象，所以我们把倾向于过拟合的节点判定为可能是成员的节点，非过拟合的节点判定为可能为非成员的节点，根据这样的标准来连接节点。但是这样做的缺点是攻击效果无法保证，其容易受到目标模型过拟合程度的影响。

第二种方法更加可靠，它利用影子模型来构造边，影子模型的数据集已知，因此成员信息也已知，所以可以用影子模型的成员信息，再加上目标模型的置信输出信息，共同构造一个图数据集。

#### 实现细节

利用参考数据集构造图数据集

首先将影子模型的训练集和测试集分开，给训练集的置信输出打上成员标签1，测试集的置信输出打上非成员标签0，他们一起作为攻击模型训练集的训练集。然后用同样的方法从目标模型上获得具有成员和非成员标签的测试集。

对于攻击模型数据集的结构信息，如概述所说，我们利用影子模型的数据集进行筛选和添加。

有了攻击数据集的节点、边和标签，我们就能够构造出一个完整的图数据集进行攻击模型的训练了。

